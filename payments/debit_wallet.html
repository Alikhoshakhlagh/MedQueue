{% load static %}

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Debit Wallet / Transfer</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
  <div class="container mt-5">
    <h1 class="mb-4">Transfer / Debit Wallet</h1>

    <!-- Messages -->
    {% if messages %}
      <div>
        {% for message in messages %}
          <div class="alert alert-{{ message.tags }}" role="alert">{{ message }}</div>
        {% endfor %}
      </div>
    {% endif %}

    <!-- Note: the view should provide `wallets` (other users' wallets) and optionally
         `user_wallets` (current user's wallets) to populate the origin selector. -->

<form method="post" action="{% url 'debit_wallet' %}">
  {% csrf_token %}
  <div class="mb-3">
    <label for="origin_wallet" class="form-label">Your wallet (origin)</label>
    <select id="origin_wallet" name="origin_wallet" class="form-select" required>
      {% if user_wallets %}
        {% for w in user_wallets %}
          <option value="{{ w.id }}">{{ w }} — Balance: {{ w.balance }}</option>
        {% endfor %}
      {% else %}
        <option disabled selected>No origin wallets available</option>
      {% endif %}
    </select>
  </div>

  <div class="mb-3">
    <label for="destination_wallet" class="form-label">Destination wallet</label>
    <select id="destination_wallet" name="destination_wallet" class="form-select" required>
      {% if wallets %}
        {% for wallet in wallets %}
          <option value="{{ wallet.id }}">{{ wallet }}</option>
        {% endfor %}
      {% else %}
        <option disabled selected>No destination wallets available</option>
      {% endif %}
    </select>
  </div>

  <div class="mb-3">
    <label for="amount" class="form-label">Amount (Toman)</label>
    <input id="amount" name="amount" type="text" class="form-control" placeholder="e.g. 10000" required>
  </div>

  <button type="submit" class="btn btn-primary">Transfer</button>
  <a href="{% url 'some_dashboard' %}" class="btn btn-link">Cancel</a>
</form>


    <hr class="my-4">
    <h6>Debug / Notes</h6>
    <ul>
      <li>If you see the error "wallet not found" it means the selected wallet id could not be resolved on the server.</li>
      <li>The view in your message currently reads `origin_wallet_id = request.POST.get('destination_wallet')` — make sure the view uses the correct POST keys (origin_wallet and destination_wallet).</li>
      <li>For better UX you can show wallet balances and owner names in the option label.</li>
    </ul>

  </div>
</body>
</html>
